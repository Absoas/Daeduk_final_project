<?xml version="1.0" encoding="UTF-8" ?>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>


<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
	integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
	crossorigin="anonymous">
<link rel="stylesheet"
	href="https://jqueryui.com/resources/demos/style.css">
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
	integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
	crossorigin="anonymous"></script>
<link rel="stylesheet"
	href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

<script src='<c:url value="/js/fullcalendar/lib/moment.min.js" />'></script>
<script src='<c:url value="/js/fullcalendar/fullcalendar.js" />'></script>
<script type="text/javascript" src='<c:url value="/js/fullcalendar/locale/ko.js" />'></script>
<link rel="stylesheet" type="text/css" href='<c:url value="/js/fullcalendar/fullcalendar.min.css" />'></link>
<link rel="stylesheet" media="print" type="text/css" 
href='<c:url value="/js/fullcalendar/fullcalendar.print.min.css" />'></link>
<style type="text/css">
	#calendar {
    max-width: 900px;
    margin: 40px auto;
  }
</style>
<script type="text/javascript">
	$(function(){
		createModal = $("#createEventModal");
		insertForm = $("[name='insertForm']");
	});

	
	
	$(".s-content").ready(function(){
		$("#calendar").fullCalendar({
			themeSystem: 'bootstrap4',
			header:{
				left: 'prev, next today',
				center: 'title',
				right: 'month,listMonth'
			},
			defaultView: 'month',
			editable : true,
			selectable: true,
			//날짜클릭
			dayClick: function(date) {
				console.log(date);
				createModal.modal("show");
			},
			eventLimit: true,
			events: eventsArray,
		});
	});
	
	
	var eventsArray = function(){
		$.ajax({
			url: '${pageContext.request.contextPath}/member/mypage/scheduleList.do',
			type: "POST",
			dataType : "json", 
			success : function(data) {
				console.log(data)
				
			},
		});
	}
	

		
		
	$("#submitButton").on("click", function(){
			var title = createModal.find("#myschedule_title").val();
			var date = createModal.find("#myschedule_date").val();
			var content = createModal.find("#myschedule_content").val();
			var mem_id = createModal.find("#mem_id").val();
			insertForm.find("[name='title']").val(title);
			insertForm.find("[name='date']").val(date);
			insertForm.find("[name='content']").val(content);
			insertForm.find("[name='mem_id']").val(mem_id);
			insertForm.submit();
	});
		
</script>
<section class="s-content">
	<div style="float:center;width:1000px;" id="calendar"></div>
</section>

<form name="insertForm" action="<c:url value='/mypage/scheduleForm.do' />" method="post">
	<input type="hidden" name="title" />
	<input type="hidden" name="date" />
	<input type="hidden" name="content" />
	<input type="hidden" name="mem_id" />
</form>


<!-- Modal -->
<div id="createEventModal" class="modal fade">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4>일정 추가</h4>
			</div>
			<div id="modalBody" class="modal-body">
				<div class="form-group">
					<input id="myschedule_title" class="form-control" type="text" placeholder="일정이름">
					<input id="mem_id" class="form-control" type="text" placeholder="아이디" >
				</div>
				<div class="form-group form-inline">
					<div class="input-group date" data-provide="datepicker">
						<input id="myschedule_date" type="text" class="form-control" value="" placeholder="일정날짜 YYYY/MM/DD">
						<div class="input-group-addon">
							<span class="glyphicon glyphicon-calendar"></span>
						</div>
					</div>
				</div>
				<div class="form-group">
					<textarea id="myschedule_content" class="form-control" rows="4" placeholder="일정 내용"></textarea>
				</div>
			</div>
			<div class="modal-footer">
				<button type="submit" class="btn btn-primary" id="submitButton">등록</button>
				<button class="btn" data-dismiss="modal" aria-hidden="true">취소</button>
			</div>
		</div>
	</div>
</div>